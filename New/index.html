<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Apple Client</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

<style>
* {
  box-sizing: border-box;
  font-family: Inter, system-ui, sans-serif;
}

body {
  margin: 0;
  width: 100vw;
  height: 100vh;
  background: #0b0b0b;
  color: #e6e6e6;
  display: flex;
  align-items: center;
  justify-content: center;
}

.top-bar {
  position: fixed;
  top: 0;
  width: 100%;
  height: 3px;
  background: linear-gradient(
    90deg,#4da3ff,#b44cff,#ff4fd8,#ff6a3d,#ffd84d,#a3ff4d
  );
}

.card {
  width: 360px;
  background: rgba(20,20,20,.65);
  border: 1px solid rgba(255,255,255,.08);
  border-radius: 16px;
  padding: 24px;
  backdrop-filter: blur(12px);
  box-shadow: 0 30px 80px rgba(0,0,0,.6);
  animation: fadeUp .45s ease;
}

@keyframes fadeUp {
  from { opacity:0; transform:translateY(22px); }
  to { opacity:1; transform:none; }
}

h1 { font-size: 20px; margin-bottom: 6px; }
p { font-size: 13px; color: #9a9a9a; margin-bottom: 18px; }

label { font-size: 12px; color: #b5b5b5; }

input {
  width: 100%;
  height: 34px;
  margin-top: 6px;
  margin-bottom: 14px;
  padding: 0 10px;
  border-radius: 8px;
  border: 1px solid rgba(255,255,255,.08);
  background: rgba(255,255,255,.05);
  color: #fff;
}

input:focus { border-color: #3b82f6; }

button {
  width: 100%;
  height: 36px;
  border-radius: 999px;
  border: none;
  background: #3b82f6;
  color: #fff;
  font-weight: 500;
  cursor: pointer;
}

button:hover { opacity: .9; }

.text-center { text-align: center; }
.text-sm { font-size: 13px; margin-top: 14px; }

.text-sm a {
  font-weight: 600;
  color: #3b82f6;
  cursor: pointer;
  text-decoration: none;
}

.text-sm a:hover { text-decoration: underline; }

#maintenance {
  display: none;
  max-width: 520px;
  text-align: center;
  color: #9a9a9a;
  animation: fadeUp .45s ease;
}

.signed {
  margin-top: 12px;
  font-size: 12px;
  color: #6f6f6f;
}

.toast {
  position: fixed;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%) translateY(20px);
  background: rgba(20,20,20,.85);
  border: 1px solid rgba(255,255,255,.08);
  border-radius: 12px;
  padding: 14px 20px;
  backdrop-filter: blur(10px);
  box-shadow: 0 20px 60px rgba(0,0,0,.6);
  font-size: 13px;
  opacity: 0;
  pointer-events: none;
  transition: opacity .25s ease, transform .25s ease;
}

.toast.show {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}
</style>
</head>

<body>

<div class="top-bar"></div>

<div id="login" class="card">
  <h1>Sign in to your account</h1>
  <p>Please enter your credentials to continue.</p>

  <label>Username</label>
  <input id="loginUser">

  <label>Password</label>
  <input id="loginPass" type="password">

  <button id="loginBtn">Sign in</button>

  <div class="text-center text-sm">
    Don't have an account?
    <a id="toRegister">Sign up</a>
  </div>
</div>

<div id="register" class="card" style="display:none">
  <h1>Create an account</h1>
  <p>Please enter your information to sign up.</p>

  <label>Username</label>
  <input id="regUser">

  <label>Password</label>
  <input id="regPass" type="password">

  <button id="registerBtn">Sign up</button>

  <div class="text-center text-sm">
    Already have an account?
    <a id="toLogin">Sign in</a>
  </div>
</div>

<div id="maintenance">
  <h1>We'll be right back</h1>
  <p>
    Apple client servers are currently undergoing scheduled maintenance
    to improve performance and security.
  </p>
  <div id="signed" class="signed"></div>
</div>

<div id="toast" class="toast"></div>

<script>
const loginCard = document.getElementById("login");
const registerCard = document.getElementById("register");
const maintenance = document.getElementById("maintenance");
const signed = document.getElementById("signed");
const toast = document.getElementById("toast");

const loginUser = document.getElementById("loginUser");
const loginPass = document.getElementById("loginPass");
const regUser = document.getElementById("regUser");
const regPass = document.getElementById("regPass");

let toastTimer;

function showToast(msg) {
  clearTimeout(toastTimer);
  toast.textContent = msg;
  toast.classList.add("show");
  toastTimer = setTimeout(() => toast.classList.remove("show"), 2000);
}

async function hashValue(value) {
  const data = new TextEncoder().encode(value);
  const buffer = await crypto.subtle.digest("SHA-256", data);
  return [...new Uint8Array(buffer)]
    .map(b => b.toString(16).padStart(2, "0"))
    .join("");
}

function getUsers() {
  return JSON.parse(localStorage.getItem("users") || "{}");
}

function saveUsers(users) {
  localStorage.setItem("users", JSON.stringify(users));
}

function showMaintenance(user) {
  loginCard.style.display = "none";
  registerCard.style.display = "none";
  maintenance.style.display = "block";
  signed.textContent = `Signed in as ${user}`;
}

toRegister.onclick = () => {
  loginCard.style.display = "none";
  registerCard.style.display = "block";
};

toLogin.onclick = () => {
  registerCard.style.display = "none";
  loginCard.style.display = "block";
};

registerBtn.onclick = async () => {
  const u = regUser.value.trim();
  const p = regPass.value;

  if (!u || !p) return showToast("Please fill in all fields.");

  const users = getUsers();
  const uh = await hashValue(u.toLowerCase());
  const ph = await hashValue(p);

  if (users[uh]) return showToast("That username is already taken.");

  users[uh] = ph;
  saveUsers(users);

  localStorage.setItem("sessionUser", uh);
  showMaintenance(u);
};

loginBtn.onclick = async () => {
  const u = loginUser.value.trim();
  const p = loginPass.value;
  const users = getUsers();

  if (!u || !p) return showToast("Please fill in all fields.");

  const uh = await hashValue(u.toLowerCase());
  const ph = await hashValue(p);

  if (users[uh] !== ph)
    return showToast("Invalid username or password.");

  localStorage.setItem("sessionUser", uh);
  showMaintenance(u);
};

document.addEventListener("keydown", e => {
  if (e.key === "Enter") {
    if (loginCard.style.display !== "none") loginBtn.click();
    if (registerCard.style.display !== "none") registerBtn.click();
  }
});

const session = localStorage.getItem("sessionUser");
if (session) {
  signed.textContent = "Signed in as (hidden)";
  loginCard.style.display = "none";
  registerCard.style.display = "none";
  maintenance.style.display = "block";
}
</script>

</body>
</html>